!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";angular.module("jsonForms",["ui.bootstrap","ui.validate","ui.grid","ui.grid.pagination","ui.grid.autoResize","jsonForms.services","jsonForms.directives","jsonForms.label","jsonForms.control","jsonForms.verticalLayout","jsonForms.horizontalLayout","jsonForms.table"]);var d=angular.module("jsonForms.directives",["jsonForms.services"]),e=function(){function a(a,b,c,d,e,f){this.RenderService=a,this.ReferenceResolver=b,this.SchemaGenerator=c,this.UISchemaGenerator=d,this.$scope=e,this.$q=f;var g=f.defer(),h=f.defer();f.all([this.fetchSchema().promise,this.fetchUiSchema().promise]).then(function(a){var c=a[0],e=a[1],i=f.defer();f.when(i.promise).then(function(a){c.uiSchema=a,b.addToMapping(JsonRefs.findRefs(a)),JsonRefs.resolveRefs(c,{},function(a,b,c){g.resolve(b),h.resolve(b.uiSchema)})}),void 0===e||null===e||""===e?JsonRefs.resolveRefs(c,{},function(a,b,c){var e=d.generateDefaultUISchema(b);i.resolve(e)}):i.resolve(e)}),f.all([g.promise,h.promise,this.fetchData()]).then(function(b){var c=b[0],d=b[1],f=b[2];e.elements=[a.render(d,c,f,"#",e.asyncDataProvider)]}),e.opened=!1,e.openDate=function(a,b){a.preventDefault(),a.stopPropagation(),b.isOpen=!0},e.validateNumber=function(a,b){if(void 0!==a&&null!==a&&isNaN(a)){b.alerts=[];var c={type:"danger",msg:"Must be a valid number!"};return b.alerts.push(c),!1}return b.alerts=[],!0},e.validateInteger=function(a,b){if(void 0!==a&&null!==a&&(isNaN(a)||""!==a&&!/^\d+$/.test(a))){b.alerts=[];var c={type:"danger",msg:"Must be a valid integer!"};return b.alerts.push(c),!1}return b.alerts=[],!0}}return a.prototype.fetchSchema=function(){if(this.$scope.schema&&this.$scope.asyncSchema())throw new Error("You cannot specify both the 'schema' and the 'async-schema' attribute at the same time.");if(this.$scope.schema){var a=this.$q.defer();return a.resolve(this.$scope.schema),a}if(this.$scope.asyncSchema())return this.$scope.asyncSchema();throw new Error("Either the 'schema' or the 'async-schema' attribute must be specified.")},a.prototype.fetchUiSchema=function(){if(this.$scope.uiSchema&&this.$scope.asyncUiSchema())throw new Error("You cannot specify both the 'ui-schema' and the 'async-ui-schema' attribute at the same time.");if(this.$scope.uiSchema){var a=this.$q.defer();return a.resolve(this.$scope.uiSchema),a}if(this.$scope.asyncUiSchema())return this.$scope.asyncUiSchema();var a=this.$q.defer();return a.resolve(void 0),a},a.prototype.fetchData=function(){var a=this.$scope.asyncDataProvider,b=this.$scope.data;if(a&&b)throw new Error("You cannot specify both the 'data' and the 'async-data-provider' attribute at the same time.");if(a){var c=a.fetchData();return c.$promise}if(this.$scope.data){var d=this.$q.defer();return d.resolve(this.$scope.data),d.promise}throw new Error("Either the 'data' or the 'async-data-provider' attribute must be specified.")},a.$inject=["RenderService","ReferenceResolver","SchemaGenerator","UISchemaGenerator","$scope","$q"],a}(),f=function(){function a(a){var b=this;this.recursionHelper=a,this.restrict="E",this.replace=!0,this.scope={element:"=",bindings:"=",topOpenDate:"=",topValidateNumber:"=",topValidateInteger:"="},this.templateUrl="templates/element.html",this.compile=function(a,c,d){return b.recursionHelper.compile(a,d)}}return a}();d.directive("control",function(){return{restrict:"E",replace:!0,scope:{control:"=",bindings:"=",topOpenDate:"=",topValidateNumber:"=",topValidateInteger:"="},templateUrl:"templates/control.html"}}).directive("jsonforms",function(){return{restrict:"E",replace:!0,scope:{schema:"=",uiSchema:"=",data:"=",asyncSchema:"&",asyncUiSchema:"&",asyncDataProvider:"="},templateUrl:"templates/form.html",controller:e}}).directive("recelement",["RecursionHelper",function(a){return new f(a)}]);var g=function(){function a(a){this.refResolver=a,this.priority=1}return a.prototype.render=function(a,b,c,d,e){var f={};return f.schemaType=a.scope.type,f.bindings=c,f.path=this.refResolver.normalize(this.refResolver.get(d)),f.label=a.label,f.id=d,{type:"Control",elements:[f],size:99}},a.prototype.isApplicable=function(a){return"Control"==a.type},a}(),h=angular.module("jsonForms.control",[]);h.run(["RenderService","ReferenceResolver",function(a,b){a.register(new g(b))}]);var i=function(){function a(a){var b=this;this.renderServ=a,this.priority=1,this.render=function(a,c,d,e,f){for(var g=b,h=function(a){if(void 0===a||0==a.length)return[];var b=e+"/elements/";return a.reduce(function(a,e,h,i){return a.push(g.renderServ.render(e,c,d,b+h,f)),a},[])},i=99,j=h(a.elements),k=j.length,l=Math.floor(i/k),m=0;m<j.length;m++)j[m].size=l;return{type:"HorizontalLayout",elements:j,size:i}}}return a.prototype.isApplicable=function(a){return"HorizontalLayout"==a.type},a}(),h=angular.module("jsonForms.horizontalLayout",[]);h.run(["RenderService",function(a){a.register(new i(a))}]);var j=function(){function a(){this.priority=1}return a.prototype.render=function(a,b,c,d,e){var f={};return f.text=a.text,{type:"Label",elements:[f],size:99}},a.prototype.isApplicable=function(a){return"Label"==a.type},a}(),h=angular.module("jsonForms.label",["jsonForms.services"]);h.run(["RenderService",function(a){a.register(new j)}]);var k=function(){function a(a,b){this.refResolver=a,this.scope=b,this.maxSize=99,this.priority=2}return a.prototype.isApplicable=function(a){return"Control"==a.type&&"array"==a.scope.type},a.prototype.render=function(a,b,c,d,e){var f=this.createTableUIElement(a,b,c,d,e);return f.tableOptions.gridOptions.data=c,f.schemaType="array",f.label=a.label,void 0===e?f.bindings=c:f.tableOptions.gridOptions.data=this.resolveColumnData(d,c),{type:"Control",elements:[f],size:this.maxSize}},a.prototype.resolveColumnData=function(a,b){return b instanceof Array?b:this.refResolver.resolve(b,a)},a.prototype.createTableUIElement=function(a,b,c,d,e){void 0===e&&(e={});var f=void 0!==e.fetchPage,g=!1,h={schemaType:"array"},i=this.refResolver.get(d),j=this,k=this.refResolver.normalize(i),l=a.columns.map(function(a,b){return{field:j.refResolver.normalize(j.refResolver.get(d+"/columns/"+b)).replace(k+"/",""),displayName:a.label}}),m={columns:a.columns,gridOptions:{enableFiltering:g,enablePaginationControls:f,enableColumnResizing:!0,enableAutoResize:!0,columnDefs:l,data:[],useExternalFiltering:!0}};return f&&(m.gridOptions.enablePagination=f,m.gridOptions.useExternalPagination=!0,m.gridOptions.paginationPageSizes=[1,2,3,4,5],m.gridOptions.paginationPageSize=1,m.gridOptions.paginationPage=1),h.enablePaginationControls=function(){m.gridOptions.enablePaginationControls=!0},h.disablePaginationControls=function(){m.gridOptions.enablePaginationControls=!1},h.fetchPagedData=function(a){m.gridOptions.data=this.refResolver.resolve(c,a)},h.fetchFilteredData=function(a){},h.setTotalItems=function(){},m.gridOptions.onRegisterApi=function(a){a.pagination.on.paginationChanged(j.scope,function(a,b){m.gridOptions.paginationPage=a,m.gridOptions.paginationPageSize=b,e.setPageSize(b),e.fetchPage(a,b).$promise.then(function(a,b){m.gridOptions.data=this.resolveColumnData(d,a,l)})})},h.tableOptions=m,h},a.prototype.findSearchTerms=function(a){for(var b=[],c=0;c<a.columns.length;c++){var d=a.columns[c].filters[0].term;void 0!==d&&null!==d&&b.push({column:a.columns[c].name,term:d})}return b},a}(),h=angular.module("jsonForms.table",[]);h.run(["RenderService","ReferenceResolver","$rootScope",function(a,b,c){a.register(new k(b,c))}]);var l=function(){function a(a){this.renderService=a,this.priority=1}return a.prototype.render=function(a,b,c,d,e){var f=this,g=function(a){if(void 0===a||0==a.length)return[];var g=d+"/elements/";return a.reduce(function(a,d,h,i){return a.push(f.renderService.render(d,b,c,g+h,e)),a},[])},h=g(a.elements);return{type:"VerticalLayout",elements:h,size:99}},a.prototype.isApplicable=function(a){return"VerticalLayout"==a.type},a}(),h=angular.module("jsonForms.verticalLayout",["jsonForms.services"]);h.run(["RenderService",function(a){a.register(new l(a))}]);var m;!function(a){var b;!function(a){var b=function(){function a(a){this.json=a,this.type=a.type,this.elements=a.elements}return a}();a.UISchemaElement=b;var c=function(){function a(a){var b=this;this.$compile=a,this.renderers=[],this.render=function(a,c,d,e,f){for(var g,h=0;h<b.renderers.length;h++)b.renderers[h].isApplicable(a)&&(void 0==g||b.renderers[h].priority>g.priority)&&(g=b.renderers[h]);if(void 0===g)throw new Error("No applicable renderer found for element "+JSON.stringify(a));return g.render(a,c,d,e,f)},this.register=function(a){b.renderers.push(a)}}return a.$inject=["$compile"],a}();a.RenderService=c;var d=function(){function a(a){var b=this;this.$compile=a,this.pathMapping={},this.Keywords=["items","properties","#"],this.addToMapping=function(a){for(var c in a)a.hasOwnProperty(c)&&(b.pathMapping[c]=a[c])},this.get=function(a){return b.pathMapping[a+"/scope/$ref"]},this.normalize=function(a){return b.filterNonKeywords(b.toPropertyFragments(a)).join("/")},this.resolve=function(a,c){var d=c+"/scope/$ref";return void 0!==b.pathMapping&&b.pathMapping.hasOwnProperty(d)&&(d=b.pathMapping[d]),b.resolveModelPath(a,d)},this.resolveModelPath=function(a,c){var d=b.toPropertyFragments(b.normalize(c));return d.reduce(function(a,b){return a instanceof Array?a.map(function(a){return a[b]}):a[b]},a)},this.toPropertyFragments=function(a){return a.split("/").filter(function(a){return a.length>0})},this.filterNonKeywords=function(a){var c=b;return a.filter(function(a){return!(-1!==c.Keywords.indexOf(a))})}}return a.$inject=["$compile"],a}();a.ReferenceResolver=d;var e=function(){function a(){var a=this;this.generateDefaultSchema=function(b){return a.schemaObject(b)},this.schemaObject=function(b){var c=a.properties(b);return{type:"object",properties:c,additionalProperties:a.allowAdditionalProperties(c),required:a.keys(a.requiredProperties(c))}},this.properties=function(b){var c={},d=a;return a.keys(b).forEach(function(a){c[a]=d.property(b[a])}),c},this.keys=function(a){return Object.keys(a)},this.property=function(b){switch(typeof b){case"string":case"boolean":case"number":return{type:typeof b};case"object":return a.schemaObjectOrNullOrArray(b);default:return{}}},this.schemaObjectOrNullOrArray=function(b){return a.isNotNull(b)?a.isArray(b)?a.schemaArray(b):a.schemaObject(b):{type:"null"}},this.schemaArray=function(b){return b.length?{type:"array",items:a.property(b[0])}:void 0},this.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},this.isNotNull=function(a){return"undefined"!=typeof a&&null!==a},this.requiredProperties=function(a){return a},this.allowAdditionalProperties=function(a){return!1}}return a}();a.SchemaGenerator=e;var f=function(){function a(){var a=this;this.generateDefaultUISchema=function(b){var c=[];return a.generateUISchema(b,c,"#",""),console.log("generated ui schema: "+JSON.stringify(c[0])),c[0]},this.generateUISchema=function(b,c,d,e){if(!b.type)throw new Error("No type found for JSON Schema element "+JSON.stringify(b));switch(b.type){case"object":var f={type:"VerticalLayout",elements:[]};if(c.push(f),e&&""!==e){var g={type:"Label",text:a.beautify(e)};f.elements.push(g)}if(!b.properties)return;var h=d+"/properties";for(var i in b.properties)("id"!==i||"string"!=typeof b.properties[i])&&a.generateUISchema(b.properties[i],f.elements,h+"/"+i,i);break;case"array":var j={type:"HorizontalLayout",elements:[]};c.push(j);var h=d+"/items";if(!b.items)return;if(b.items instanceof Array)for(var k=0;k<b.items.length;k++)a.generateUISchema(b.items[k],j.elements,h+"["+k+"]","");else a.generateUISchema(b.items,j.elements,h,"");break;case"string":case"number":case"integer":case"boolean":var l=a.getControlObject(a.beautify(e),d);c.push(l);break;default:throw new Error("Unknown type: "+JSON.stringify(b))}},this.getControlObject=function(a,b){return{type:"Control",label:a,scope:{$ref:b}}},this.beautify=function(a){if(a&&a.length>0){var b=a.split(/(?=[A-Z])/).map(function(a){return a.toLowerCase()});b[0]=b[0].charAt(0).toUpperCase()+b[0].slice(1),a=b.join(" ")}return a}}return a}();a.UISchemaGenerator=f;var g=function(){function a(a){var b=this;this.$compile=a,this.compile=function(a,c){angular.isFunction(c)&&(c={post:c});var d,e=a.contents().remove(),f=b;return{pre:c&&c.pre?c.pre:null,post:function(a,b){d||(d=f.$compile(e)),d(a,function(a){b.append(a)}),c&&c.post&&c.post.apply(null,arguments)}}}}return a.$inject=["$compile"],a}();a.RecursionHelper=g}(b=a.services||(a.services={}))}(m||(m={})),angular.module("jsonForms.services",[]).service("RecursionHelper",m.services.RecursionHelper).service("ReferenceResolver",m.services.ReferenceResolver).service("RenderService",m.services.RenderService).service("SchemaGenerator",m.services.SchemaGenerator).service("UISchemaGenerator",m.services.UISchemaGenerator),angular.module("jsonForms").run(["$templateCache",function(a){a.put("templates/control.html",'<div ng-switch on="control.schemaType" class="form-group top-buffer"><label for="control.id" ng-class="control.labelclass">{{control.label}}</label><div ng-class="control.inputclass"><div ng-switch-when="array" name="control.label"><div class="row"><div ui-grid="control.tableOptions.gridOptions" ui-grid-auto-resize ui-grid-pagination class="grid"></div></div></div><input ng-switch-when="string" type="text" ng-model="control.bindings[control.path]" id="control.id" class="form-control qb-control qb-control-string" name="control.displayname"> <input ng-switch-when="number" type="text" ng-model="control.bindings[control.path]" ui-validate="\'topValidateNumber($value, control)\'" id="control.id" class="form-control qb-control qb-control-number" name="control.displayname"> <input ng-switch-when="integer" type="text" ng-model="control.bindings[control.path]" ui-validate="\'topValidateInteger($value, control)\'" id="control.id" class="form-control qb-control qb-control-integer" name="control.displayname"><div ng-switch-when="boolean" class="checkbox-inline" for="control.value"><input type="checkbox" ng-model="control.bindings[control.path]" name="control.displayname" id="control.id" class="qb-control qb-control-boolean">&nbsp;</div><div ng-switch-when="date-time" class="input-group"><input type="text" datepicker-popup="dd.MM.yyyy" ng-model="control.bindings[control.path]" close-text="Close" is-open="control.isOpen" id="control.id" class="form-control qb-control qb-control-datetime" n ame="control.displayname"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="topOpenDate($event,control)"><i class="glyphicon glyphicon-calendar"></i></button></span></div><select ng-switch-when="enum" ng-model="control.bindings[control.path]" ng-options="option as option for option in control.options" id="control.id" class="form-control qb-control qb-control-enum" name="control.label"></select><alert ng-repeat="alert in control.alerts" type="{{alert.type}}" class="top-buffer-s qb-alert">{{alert.msg}}</alert></div></div>'),a.put("templates/element.html",'<recursive><div ng-if="element.type==\'Label\'" class="col-sm-{{element.size}} qb-label">{{element.elements[0].text}}</div><control ng-if="element.type==\'Control\'" control="element.elements[0]" bindings="element.elements[0].bindings" top-open-date="topOpenDate" top-validate-number="topValidateNumber" top-validate-integer="topValidateInteger" class="col-sm-{{element.size}}"></control><!-- this should be moved to control.html ? --><fieldset ng-if="element.type==\'HorizontalLayout\'" class="col-sm-{{element.size}}"><div class="row"><recelement ng-repeat="child in element.elements" element="child" bindings="bindings" top-open-date="topOpenDate" top-validate-number="topValidateNumber" top-validate-integer="topValidateInteger"></recelement></div></fieldset><fieldset ng-if="element.type==\'VerticalLayout\'" class="col-sm-{{element.size}}"><recelement ng-repeat="child in element.elements" element="child" bindings="bindings" top-open-date="topOpenDate" top-validate-number="topValidateNumber" top-validate-integer="topValidateInteger"></recelement></fieldset></recursive>'),a.put("templates/form.html",'<div><form role="form" class="qb-form rounded"><recelement ng-repeat="child in elements" element="child" bindings="bindings" top-open-date="openDate" top-validate-number="validateNumber" top-validate-integer="validateInteger"></recelement></form></div>')}])},{}]},{},[1]);